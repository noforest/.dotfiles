set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"
set -ag terminal-overrides ",*:Tc"  # Enable true color

# THEME
set -g pane-border-style "fg=#698DDA"
set -g pane-active-border-style "bg=default fg=#698DDA"

set -g pane-border-style "fg=default"
set -g pane-active-border-style "bg=default fg=default"
# set -g status-bg black
# set -g status-fg white
# set -g window-status-current-style bg=white,fg=black,bold
# set -g status-interval 60
# set -g status-left-length 30
# set -g status-left '#[fg=green](#S) '
# set -g status-right '#[fg=white]%H:%M#[default]'

# KEYBINDS
set -g xterm-keys on


# # Ctrl+d : scroll vers le bas (mode vim style)
# bind-key -n C-d if-shell \
#     "[[ $(tmux display-message -p '#{pane_in_mode}') == 1 ]]" \
#     "send-keys C-d" \
#     "copy-mode; send-keys C-d"
#
# # Ctrl+u : scroll vers le haut (mode vim style)
# bind-key -n C-u if-shell \
#     "[[ $(tmux display-message -p '#{pane_in_mode}') == 1 ]]" \
#     "send-keys C-u" \
#     "copy-mode; send-keys C-u"


bind-key -n C-Down copy-mode \; send-keys -X halfpage-down
bind-key -n C-Up   copy-mode \; send-keys -X halfpage-up
bind-key -T copy-mode-vi C-Down send-keys -X halfpage-down
bind-key -T copy-mode-vi C-Up   send-keys -X halfpage-up

# Ctrl+s : toggle copy-mode
bind-key -n C-s if-shell -F "#{pane_in_mode}" \
    "send-keys C-c" \
    "copy-mode"

# Désactive C-f si c'est nvim
    bind-key -n C-f if-shell \
        '[ "#{pane_current_command}" = "nvim" ]' \
        'send-keys C-f' \
        'send-keys "fuzzy_cd\n"'

# Désactive C-d si c'est nvim
        bind-key -n C-d if-shell \
            '[ "#{pane_current_command}" = "nvim" ]' \
            'send-keys C-d' \
            'send-keys "confirm-exit\n"'

bind -n M-z next-window
bind -n M-a previous-window

# Alt+w  (M-w) fermer le panneau courant
bind -n M-w kill-pane

# Alt+j pour aller au panneau suivant
bind -n M-j select-pane -t :.+
# Alt+k pour aller au panneau précédent
bind -n M-k select-pane -t :.-

# Comme nvim sauf avec ALT et non avec SPACE
# Alt+n : nouvelle fenêtre divisée horizontalement (split horizontal)
bind -n M-v split-window -h -c "#{pane_current_path}"

# Alt+v : nouvelle fenêtre divisée verticalement (split vertical)
bind -n M-n split-window -v -c "#{pane_current_path}"

# Alt+e : lancer nnn (explorateur de fichiers) dans un nouveau pane flottant
# tmux ne gère pas vraiment les "floating windows", donc on peut ouvrir un nouveau pane
# bind -n M-e display-popup -E "tmux new-session -A -s floating"
# bind -n M-e display-popup -d '#{pane_current_path}' -x R -h 70% -w 60% -E 'tmux new-session yazi \; set status off'

bind -n M-e display-popup -d '#{pane_current_path}' -x C -y C -h 70% -w 60% -E 'tmux new-session yazi \; set status off'

bind -n M-b set -g status

# Redimensionner les panes avec Alt + flèches
bind -n M-Left resize-pane -L 5
bind -n M-Right resize-pane -R 5
bind -n M-Up resize-pane -U 5
bind -n M-Down resize-pane -D 5

# resize pane
bind -n -r -N "Resize the pane left by 5" M-H resize-pane -L 5
bind -n -r -N "Resize the pane down by 5" M-J resize-pane -D 5
bind -n -r -N "Resize the pane up by 5" M-K resize-pane -U 5
bind -n -r -N "Resize the pane right by 5" M-L resize-pane -R 5

# Alt + Entrée  ou Alt + c: nouvelle fenêtre (current path)
bind -n M-Enter new-window -c "#{pane_current_path}"
bind -n M-c new-window -c "#{pane_current_path}"

# bind -n M-Enter new-window
# # Alt + o : nouvelle fenêtre dans le répertoire de la fenêtre active
# bind -n M-\* new-window -c "#{pane_current_path}"

# Goto window 1 to 5 using Alt + & é " ' (
bind -n -N "Goto window 1" M-& select-window -t 1
bind -n -N "Goto window 2" M-é select-window -t 2
bind -n -N "Goto window 3" M-\" select-window -t 3
bind -n -N "Goto window 4" M-\' select-window -t 4
bind -n -N "Goto window 5" M-\( select-window -t 5


set -g @yank_action "copy-pipe"

# GENERAL
set -g base-index 1
set-option -g history-limit 100000
set -g mouse on
set -s escape-time 0
unbind-key Escape
bind-key b set-option status
set-environment -g DISPLAY $DISPLAY

# PLUGINS
# List of plugins
set -g @plugin 'tmux-plugins/tpm'

set -g @plugin 'niksingh710/minimal-tmux-status'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'thewtex/tmux-mem-cpu-load'
set -g @plugin 'tmux-plugins/tmux-yank'
# set -g @plugin 'noscript/tmux-mighty-scroll'

############################################################################################

# These are the default values used inside the plugin to achieve the preview shown above.
set -g @minimal-tmux-fg "#000000"
set -g @minimal-tmux-bg "#698DDA"
set -g @minimal-tmux-indicator-str "  #S  "
# expanded icon (fullscreen icon)
set -g @minimal-tmux-expanded-icon "󰊓 "
set -g status-right-length 100
set -g status-left-length 100
set -g @minimal-tmux-status-right "RAM: #{ram_percentage} | CPU: #{cpu_percentage} | %A %h-%d %H:%M "

# set -g @minimal-tmux-status-right "RAM: #(/home/for/.tmux/plugins/tmux-mem-cpu-load/tmux-mem-cpu-load -m 2 --interval 2) | CPU: #{cpu_percentage} | %A %h-%d %H:%M"

############################################################################################


# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
