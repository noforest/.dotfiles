#!/bin/sh

# Show wifi ğŸ“¶ and percent strength or ğŸ“¡ if none.
# Show ğŸŒ if connected to ethernet or â if none.
# Show ğŸ”’ if a vpn connection is active

case $BUTTON in
	1) st -e nmtui ;;
esac



# Nom de l'interface Wi-Fi
interface="wlp2s0"

# Nom de l'interface Ethernet (Ã  adapter si nÃ©cessaire)
# interface_eth="enp3s0f3u2u1"

# Fonction pour obtenir le pourcentage de signal Wi-Fi
get_wifi_signal_percentage() {
    local interface=$1
    local signal_strength


    
    signal_strength="$(awk '/^\s*w/ {print int($3 * 100 / 70)}' /proc/net/wireless)"
    
    if [ -n "$signal_strength" ]; then
            echo "$signal_strength"
    else
	    echo "0"  # Aucun signal dÃ©tect
    fi

}

# VÃ©rifier l'Ã©tat du Wi-Fi
if [ -e "/sys/class/net/$interface/operstate" ]; then
    operstate=$(cat /sys/class/net/$interface/operstate)

    if [ "$operstate" = "up" ]; then
        wifi_percentage=$(get_wifi_signal_percentage "$interface")
        
        # DÃ©finir les icÃ´nes en fonction du pourcentage de signal
        if [ "$wifi_percentage" -ge 80 ]; then
            wifi_icon="ó°¢¾ âŸ" # Wi-Fi plein
            # wifi_icon="ó°¤¨ âŸ" # Wi-Fi plein
        elif [ "$wifi_percentage" -ge 40 ]; then
            wifi_icon="ó°¢½ âŸ"    # Wi-Fi moitiÃ©
            # wifi_icon="ó°¤¢ âŸ"    # Wi-Fi moitiÃ©
        else
            wifi_icon="ó°¢¼ âŸ"  # Wi-Fi vide (pour un signal faible)
            # wifi_icon="ó°¤Ÿ âŸ"  # Wi-Fi vide (pour un signal faible)
        fi
        wifi_status="$wifi_icon${wifi_percentage}%â€‰"
    else
        wifi_status="ï€âŸ"
        # wifi_status="ó°¤®âŸ"
    fi
else
    wifi_status="Interface Wi-Fi non trouvÃ©e"
fi

# VÃ©rifier l'Ã©tat de la connexion Ethernet
# if [ -e "/sys/class/net/$interface_eth/operstate" ]; then
#     operstate_eth=$(cat /sys/class/net/$interface_eth/operstate)
#
#     if [ "$operstate_eth" = "up" ]; then
#         ethernet_status="ó°ˆ€ "  # Ethernet connectÃ©
#     else
#         ethernet_status="ï€ "  # Ethernet dÃ©connectÃ©
#     fi
# else
#     ethernet_status="ï€ "  # Interface Ethernet non trouvÃ©e ou non connectÃ©e
# fi

# Afficher l'icÃ´ne Wi-Fi
echo " $wifi_status$ethernet_status"
# printf "%s%s\u200A\n" " $wifi_status" "$ethernet_status"

